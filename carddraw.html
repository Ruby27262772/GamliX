<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Rigged Card Draw | GambliX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(to right, #111, #1f1f1f);
      color: white;
      text-align: center;
      padding: 20px;
    }

    h1 {
      color: #ff0070;
      text-shadow: 0 0 5px #ff0070;
    }

    .wallet {
      font-size: 1.3em;
      margin-bottom: 10px;
      color: #00ffcc;
    }

    .cards {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin: 30px 0;
      perspective: 1000px;
    }

    .card {
      width: 130px;
      height: 190px;
      background: white;
      color: black;
      font-size: 2.5em;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: transform 0.6s;
      transform-style: preserve-3d;
      box-shadow: 0 0 15px cyan;
      position: relative;
    }

    .card .front, .card .back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5em;
    }

    .card .back {
      background: linear-gradient(45deg, #333, #111);
      color: white;
      transform: rotateY(180deg);
    }

    .card.flipped {
      transform: rotateY(180deg);
    }

    button {
      padding: 14px 30px;
      font-size: 1.1em;
      background: #00cc88;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
    }

    button:hover {
      background: #00e6aa;
    }

    .result {
      font-size: 1.6em;
      margin-top: 20px;
      color: #ffd700;
      text-shadow: 0 0 5px #ffd700;
    }

    .back-to-menu {
      display: block;
      margin-top: 30px;
      font-size: 1em;
      color: #00ffee;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>üÉè GambliX High Draw</h1>
  <div class="wallet">üí∞ Tokens: <span id="wallet">0</span></div>

  <div class="cards">
    <div class="card" id="playerCard">
      <div class="front">?</div>
      <div class="back" id="playerBack">?</div>
    </div>
    <div class="card" id="houseCard">
      <div class="front">?</div>
      <div class="back" id="houseBack">?</div>
    </div>
  </div>

  <button onclick="playGame()" id="drawBtn">Draw Cards (500 Tokens)</button>
  <div class="result" id="resultText"></div>
  <a class="back-to-menu" href="index.html">‚Üê Back to Menu</a>

  <script>
    const walletDisplay = document.getElementById("wallet");
    const resultText = document.getElementById("resultText");
    const drawBtn = document.getElementById("drawBtn");

    const playerCard = document.getElementById("playerCard");
    const houseCard = document.getElementById("houseCard");
    const playerBack = document.getElementById("playerBack");
    const houseBack = document.getElementById("houseBack");

    let wallet = parseInt(localStorage.getItem("tokens") || "1000");
    updateWallet();

    function updateWallet() {
      walletDisplay.textContent = wallet;
      localStorage.setItem("tokens", wallet);
    }

    function getCardValue() {
      return Math.floor(Math.random() * 13) + 1; // 1‚Äì13
    }

    function getSuit() {
      const suits = ["‚ô†", "‚ô•", "‚ô¶", "‚ô£"];
      return suits[Math.floor(Math.random() * suits.length)];
    }

    function cardName(val) {
      const faces = { 1: "A", 11: "J", 12: "Q", 13: "K" };
      return faces[val] || val;
    }

    function resetCards() {
      playerCard.classList.remove("flipped");
      houseCard.classList.remove("flipped");
      playerBack.textContent = "?";
      houseBack.textContent = "?";
    }

    function playGame() {
      if (wallet < 500) {
        alert("Not enough tokens!");
        return;
      }

      resetCards();
      wallet -= 500;
      updateWallet();
      resultText.textContent = "";

      drawBtn.disabled = true;

      setTimeout(() => {
        let outcomeRoll = Math.random();
        let player, house;

        if (outcomeRoll < 0.6) {
          // House wins
          do {
            player = getCardValue();
            house = getCardValue();
          } while (player >= house);
          resultText.textContent = "üíÄ You lose!";
        } else if (outcomeRoll < 0.75) {
          // Draw
          player = getCardValue();
          house = player;
          wallet += 500;
          resultText.textContent = "‚öñÔ∏è Draw! +500 refund";
        } else {
          // Player wins
          do {
            player = getCardValue();
            house = getCardValue();
          } while (player <= house);
          wallet += 1000;
          resultText.textContent = "üéâ You win! +1000 tokens";
        }

        // Animate reveal
        const playerText = `${cardName(player)} ${getSuit()}`;
        const houseText = `${cardName(house)} ${getSuit()}`;
        playerBack.textContent = playerText;
        houseBack.textContent = houseText;

        playerCard.classList.add("flipped");
        houseCard.classList.add("flipped");

        updateWallet();
        drawBtn.disabled = false;
      }, 600);
    }
  </script>
</body>
</html>